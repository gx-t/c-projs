<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN""http://www.w3.org/TR/html4/loose.dtd">
<HTML
><HEAD
><TITLE
>Creating a Tree View</TITLE
><META
NAME="GENERATOR"
CONTENT="Modular DocBook HTML Stylesheet Version 1.79"><LINK
REL="HOME"
TITLE="GTK+ 2.0 Tree View Tutorial"
HREF="treeview-tutorial.html"><LINK
REL="PREVIOUS"
TITLE="Storing Data Structures: of Pointers, GBoxed Types, and GObject (TODO)"
HREF="sec-treemodel-storing-structs.html"><LINK
REL="NEXT"
TITLE="Tree View Look and Feel"
HREF="sec-treeview-look.html"><LINK
REL="STYLESHEET"
TYPE="text/css"
HREF="./treeview-tutorial.css"></HEAD
><BODY
CLASS="chapter"
BGCOLOR="#FFFFFF"
TEXT="#000000"
LINK="#0000FF"
VLINK="#840084"
ALINK="#0000FF"
><DIV
CLASS="NAVHEADER"
><TABLE
SUMMARY="Header navigation table"
WIDTH="95%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TH
COLSPAN="3"
ALIGN="center"
>GTK+ 2.0 Tree View Tutorial</TH
></TR
><TR
><TD
WIDTH="10%"
ALIGN="left"
VALIGN="bottom"
><A
HREF="sec-treemodel-storing-structs.html"
ACCESSKEY="P"
>&#60;&#60;&#60; Previous</A
></TD
><TD
WIDTH="80%"
ALIGN="center"
VALIGN="bottom"
></TD
><TD
WIDTH="10%"
ALIGN="right"
VALIGN="bottom"
><A
HREF="sec-treeview-look.html"
ACCESSKEY="N"
>Next &#62;&#62;&#62;</A
></TD
></TR
></TABLE
><HR
ALIGN="LEFT"
WIDTH="95%"></DIV
><DIV
CLASS="chapter"
><H1
><A
NAME="sec-treeview"
></A
>Chapter 4. Creating a Tree View</H1
><P
>&#13;In order to display data in a tree view widget, we need to create one
first, and we need to instruct it where to get the data to display
from.
</P
><P
>&#13;A new tree view is created with:
</P
><TABLE
BORDER="0"
BGCOLOR="#e3e3c4"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="programlisting"
>&#13;  GtkWidget *view;

  view = gtk_tree_view_new();
</PRE
></TD
></TR
></TABLE
><DIV
CLASS="sect1"
><H1
CLASS="sect1"
><A
NAME="sec-treeview-connect-model"
>4.1. Connecting Tree View and Model</A
></H1
><P
>&#13;Before we proceed to the next section where we display data on the screen,
we need connect our data store to the tree view, so it knows where to
get the data to display from. This is achieved with
<A
HREF="http://developer.gnome.org/doc/API/2.0/gtk/GtkTreeView.html#gtk-tree-view-set-model"
TARGET="_top"
>&#13;<TT
CLASS="literal"
>gtk_tree_view_set_model</TT
></A
>, which will by itself
do very little. However, it is a prerequisite for what we do in the
following sections.
<A
HREF="http://developer.gnome.org/doc/API/2.0/gtk/GtkTreeView.html#gtk-tree-view-new-with-model"
TARGET="_top"
>&#13;<TT
CLASS="literal"
>gtk_tree_view_new_with_model</TT
></A
> is a convenience
function for the previous two.
</P
><P
>&#13;<A
HREF="http://developer.gnome.org/doc/API/2.0/gtk/GtkTreeView.html#gtk-tree-view-get-model"
TARGET="_top"
>&#13;<TT
CLASS="literal"
>gtk_tree_view_get_model</TT
></A
> will return the model that
is currently attached to a given tree view, which is particularly useful in
callbacks where you only get passed the tree view widget (after all, we do not
want to go down the road of global variables, which will inevitably lead to
the Dark Side, do we?).
</P
><DIV
CLASS="sect2"
><H2
CLASS="sect2"
><A
NAME="sec-treeview-connect-model-refcounting"
>4.1.1. Reference counting</A
></H2
><P
>&#13;Tree models like <TT
CLASS="literal"
>GtkListStore</TT
> and <TT
CLASS="literal"
>GtkTreeStore</TT
>
are <TT
CLASS="literal"
>GObjects</TT
> and have a reference count of 1 after creation. The
tree view will add its own reference to the model when you add the model with
<TT
CLASS="literal"
>gtk_tree_view_set_model</TT
>, and will unref it again when you replace
the model with another model, unset the model by passing <TT
CLASS="literal"
>NULL</TT
> as
a model, or when the tree view is destroyed.

<A
NAME="AEN464"
HREF="#FTN.AEN464"
><SPAN
CLASS="footnote"
>[1]</SPAN
></A
>

</P
><P
>&#13;This means that you need to take care of "your" reference yourself, otherwise the
model will not be destroyed properly when you disconnect it from the tree view, and
its memory will not be freed (which does not matter much if the same model is
connected to the tree view from application start to end). If you plan to use
the same model for a tree view for the whole duration of the application, you can
get rid of "your" reference right after you have connected the model to the
view - then the model will be destroyed automatically when the tree view is
destroyed (which will be automatically destroyed when the window it is in is
destroyed):
</P
><TABLE
BORDER="0"
BGCOLOR="#e3e3c4"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="programlisting"
>&#13;  GtkListStore *liststore;
  GtkWidget    *view;

  view = gtk_tree_view_new();

  liststore = gtk_list_store_new(1, G_TYPE_STRING);

  gtk_tree_view_set_model(GTK_TREE_VIEW(view), GTK_TREE_MODEL(liststore));

  g_object_unref(liststore);

  /* Now the model will be destroyed when the tree view is destroyed */
</PRE
></TD
></TR
></TABLE
></DIV
></DIV
></DIV
><H3
CLASS="FOOTNOTES"
>Notes</H3
><TABLE
BORDER="0"
CLASS="FOOTNOTES"
WIDTH="100%"
><TR
><TD
ALIGN="LEFT"
VALIGN="TOP"
WIDTH="5%"
><A
NAME="FTN.AEN464"
HREF="sec-treeview.html#AEN464"
><SPAN
CLASS="footnote"
>[1]</SPAN
></A
></TD
><TD
ALIGN="LEFT"
VALIGN="TOP"
WIDTH="95%"
><P
>&#13;'Reference counting' means that an object has a counter that can be
increased or decreased (ref-ed and unref-ed). If the counter is unref-ed to 0, the
object is automatically destroyed. This is useful, because other objects or
application programmers only have to think about whether <I
CLASS="emphasis"
>they themselves</I
>
are still using that object or not, without knowing anything about others also using
it. The object is simply automatically destroyed when no one is using it any more.
</P
></TD
></TR
></TABLE
><DIV
CLASS="NAVFOOTER"
><HR
ALIGN="LEFT"
WIDTH="95%"><TABLE
SUMMARY="Footer navigation table"
WIDTH="95%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
><A
HREF="sec-treemodel-storing-structs.html"
ACCESSKEY="P"
>&#60;&#60;&#60; Previous</A
></TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="treeview-tutorial.html"
ACCESSKEY="H"
>Home</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
><A
HREF="sec-treeview-look.html"
ACCESSKEY="N"
>Next &#62;&#62;&#62;</A
></TD
></TR
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
>Storing Data Structures: of Pointers, GBoxed Types, and GObject (TODO)</TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
>&nbsp;</TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
>Tree View Look and Feel</TD
></TR
></TABLE
></DIV
></BODY
></HTML
>